# Contractor.FindOrCreate

## Описание

Метод гарантирует, что после его выполнения в базе будет существовать контрагент с указанным в параметрах ИНН, если реквизиты являются корректными.

Вначале выполняется поиск контрагента по ИНН и КПП в базе Биллинга (прочие реквизиты для поиска не используются). Поиск осуществляется по ИНН и текущему КПП, а также по списку КПП, которые были установлены у контрагента раньше. Если контрагент найден, он используется в качестве результата, при этом его название может быть обновлено на указанное в параметрах. Если контрагента с указанными ИНН и КПП найти не удалось, возможны 2 варианта:

- в базе Биллинга создаётся контрагент с указанными реквизитами (ИНН, КПП и прочими) и возвращается его идентификатор;
- возвращается идентификатор контрагента с указанным в параметрах ИНН и каким-либо другим КПП (вариант возможен в случае поиска юридического лица).

Для того чтобы узнать КПП контрагента, идентификатор которого был возвращён, можно использовать метод [Contractor.InfoByID](Contractor.InfoByID.md). Для того чтобы гарантированно создать контрагента с требуемым КПП, можно воспользоваться методами [Contractor.CreateWithAccount](Contractor.CreateWithAccount.md) и [Account.AddContractor](Account.AddContractor.md), если необходимо добавить контрагента в какой-либо аккаунт.

До того, как будет выполнен поиск контрагента с указанными ИНН и КПП, эти параметры подвергаются проверке. Запрос отвергается (то есть метод возвращает ошибку) в следующих случаях:

- Некорректный ИНН: длина ИНН отличается от 10 или 12 знаков, ИНН включает в себя нецифровые символы, ИНН состоит из одних нулей, неверна контрольная сумма ИНН;
- Некорректный КПП: длина КПП отличается от 9 знаков, КПП содержит нецифровые символы, другие ошибки;
- Некорректная пара ИНН и КПП: длина ИНН – 12 символов, длина КПП – 9 символов или длина ИНН – 10 символов, КПП – пуст.

## Параметры

Параметры – запись «ContractorData», включающая в себя следующие поля:

| Название       | Тип    | Описание                                                                 |
|----------------|--------|--------------------------------------------------------------------------|
| **INN**        | Строка | ИНН контрагента (ЮЛ или ИП)                                              |
| **KPP**        | Строка | КПП контрагента–ЮЛ (для ИП должен быть пустым или отсутствовать)         |
| **Name**       | Строка | Название контрагента                                                     |
| RealAddress    | Строка | Фактический адрес контрагента                                            |
| LegalAddress   | Строка | Юридический адрес контрагента                                            |
| EmailAddress   | Строка | Адрес электронной почты контрагента                                      |
| OGRN           | Строка | ОГРН контрагента–ЮЛ или ОГРНИП контрагента–ИП                            |
| PhoneNumber    | Строка | Контактный телефон контрагента                                           |
| Representative | Строка | ФИО представителя контрагента                                            |

## Замечание

Поля, выделенные **полужирным шрифтом**, являются обязательными; остальные поля могут отсутствовать или быть пустыми.

## Результат

ID контрагента (целое число).

## Пример вызова

```json
{
    "jsonrpc": "2.0",
    "method": "Contractor.FindOrCreate",
    "params": {
        "ContractorData": {
            "s": {
                "INN": "Строка",
                "KPP": "Строка",
                "Name": "Строка"
            },
            "d": {
                "INN": "6449058159",
                "KPP": "644901001",
                "Name": "ЕВРО-ЗАПЧАСТЬ, ООО"
            }
        }
    },
    "protocol": 2,
    "id": 0
}