# Account.CreateOrEditLicense

## Описание

Метод проверяет корректность переданных параметров и создаёт лицензию с указанными услугами, если всё в порядке. При редактировании, в лицензии остаются только переданные услуги, то есть, что передали, то и получится в итоге.

## Параметры

| Название    | Тип          | Описание |
|-------------|--------------|----------|
| AccountID  | Число целое | Идентификатор аккаунта – будущего обладателя лицензии |
| LicenseData| Запись      | Данные лицензии |

Запись `LicenseData` включает в себя следующие поля:

| Название     | Тип              | Описание |
|--------------|------------------|----------|
| ServiceSet  | Список записей  | Набор услуг, которые должна включать в себя лицензия |
| LicenseID   | Строка (UUID)   | Уникальный идентификатор лицензии |
| IsExtension | Логический      | Является ли создаваемая (редактируемая) лицензия расширением некоторой базовой лицензии |
| BaseLicenseID | Строка        | Идентификатор базовой лицензии (анализируется в том случае, если создаётся или редактируется лицензия с типом расширение) |
| InvoiceNum  | Строка          | Номер счёта лицензии |
| ContractorID| Число целое     | Идентификатор контрагента, к которому будет привязана лицензия, в случае смены тарифа (см. параметр TariffChange) – идентификатор контрагента, тариф которого нужно изменить. С версии 1.2.2 должен быть передан обязательно при создании новой лицензии. В случае редактирования существующей лицензии может быть не передан, если будет указан, то лицензия будет перепривязана к этому контрагенту |
| TariffChange| Логический     | Предполагает ли активация данной лицензии смену тарифа. Может быть не передан. Рекомендуется передавать данный параметр со значение true в том случае, когда выполняется смена тарифа для аккаунта в целом или отдельной организации. В этом случае необходимо передавать в параметре BaseLicenseID идентификатор базовой лицензии, тариф в которой необходимо изменить. Параметр IsExtension должен содержать значение true |
| IsLinkup    | Логический      | Принудительно создать договор с отдельным сроком действия (отличным от основного срока с услугой Аккаунт). Если параметр не передан, или задано значение false, метод работает по-старому - будет действовать в рамках текущего срока лицензии. Допускает создание отдельного срока только в рамках отдельной темы. Два разных срока в рамках одной темы быть не может. Например, нельзя сделать корпоративную и базовую (с ТП Базовый) лицензию с разным сроком, но можно отдельным сроком сделать отчетность и отдельным сроком сделать Торги. Параметр может не передаваться |
| Duration    | Число целое     | Количество кварталов действия лицензии. Можно задать одно из указаных значений: 1 -квартальная, 4 -годовая, 8 -2х летняя, 12 -3х летняя. Другие значения не принимаются. По умолчанию считается, что длительность лицензии –1 год. |

Идентификатор лицензии обязательно должен быть передан в случае редактирования лицензии (включая случай смены тарифного плана). Если лицензия с переданным идентификатором отсутствует, то метод завершится с ошибкой. В случае создания лицензии в качестве идентификатора должно быть передано значение null.

Набор услуг `ServiceSet` имеет следующий формат:

| Название     | Тип          | Описание |
|--------------|--------------|----------|
| ServiceID   | Строка      | Идентификатор услуги |
| ServiceCount| Число целое | Требуемое количество услуг данного типа |

## Результат

Запись с параметрами:

| Название     | Тип          | Описание |
|--------------|--------------|----------|
| LicenseID   | Строка (UUID)| Идентификатор созданной или изменённой лицензии |
| ServiceSet  | Список записей | Набор включенных в лицензию услуг (включая стоимость) |
| LicenseCost | Денежный    | Стоимость лицензии (всех услуг, входящих в её состав) |
| TariffChange| Логический  | Предполагает ли активация данной лицензии смену тарифа |

Набор услуг `ServiceSet` результата имеет следующий формат:

| Название     | Тип          | Описание |
|--------------|--------------|----------|
| ServiceID   | Строка      | Идентификатор услуги |
| ServiceCount| Число целое | Количество услуг данного типа, указанное в параметрах метода |
| ServiceCost | Денежный    | Стоимость указанного количества услуг данного типа с учётом скидок |

## Пример вызова

```json
{
    "jsonrpc": "2.0",
    "method": "Account.CreateOrEditLicense",
    "params": {
        "AccountID": 4363913,
        "LicenseData": { 
            "s": {
                "IsExtension": "Логическое",
                "LicenseID": "Строка",
                "BaseLicenseID": "Строка",
                "ContractorID": "Число целое",
                "InvoiceNum": "Строка",
                "ServiceSet": "Выборка"
            },
            "d": {
                "IsExtension": false,
                "LicenseID": null,
                "BaseLicenseID": null,
                "ContractorID": 50718325,
                "InvoiceNum": "019007602",
                "ServiceSet": {
                    "s": [{
                        "n": "ServiceID",
                        "t": "Строка"
                    }, {
                        "n": "ServiceCount",
                        "t": "Число целое"
                    }],
                    "d": [
                        ["EOpSBISfrmB2o", 1],
                        ["EOpSBISfrmOXO2d",2]
                    ]
                }
            }
        }
    },
    "protocol": 2,
    "id": 0
}